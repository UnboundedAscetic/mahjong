@if (groups.length > 1) {
	<div class="headline-anchors">
		@for (group of groups; track group; let i = $index) {
			<a (click)="scrollToGroup(i)">{{ group.name }}</a>
		}
	</div>
}
<div #scrollHost class="groups">
	@for (group of groups; track group; let i = $index) {
		<div class="group" id="group-{{i}}">
			@if (groups.length > 1) {
				<div class="group-name" (click)="group.expanded = !group.expanded">
					<span class="group-expander" [class.expanded]="group.expanded"></span>
					{{ group.name }}
					<span class="group-count">@if (!group.isRandom) {
						[{{ group.layouts.length }}]
					}</span>
				</div>
			}
			@if (group.expanded) {
				@if (group.isRandom) {
					<div class="previews">
						@for (item of group.layouts; track item) {
							<div class="preview"
									 tabindex="0"
									 [id]="'item-'+item.layout.id"
									 [class.selected]="item.selected"
									 (keydown.enter)="onStart(item)"
									 (click)="onStart(item)"
							>
								@if (item.visible) {
									<app-layout-preview class="svg-board" [svg]="item.layout.previewSVG" [alt]="item.layout.name"></app-layout-preview>
								} @else {
									<div class="preview-placeholder"
											 [id]="'item-'+item.layout.id"
											 [class.selected]="item.selected"
									>
									</div>
								}
								<div class="preview-name">{{ item.layout.name }}</div>
							</div>
						}
						<div class="preview-random">
							<div class="random-options">
								<label>
									<!-- https://www.svgrepo.com/svg/512271/focus-vertical-842 Public Domain-->
									<svg width="20px" height="20px" viewBox="-2 0 20 20">
										<path id="focus_vertical-[#842]" d="M7,20 L7,0 L9,0 L9,20 Z M0,2 L5,2 L5,4 L2,4 L2,7 L0,7 Z M11,2 L16,2 L16,7 L14,7 L14,4 L11,4 Z M0,18 L0,13 L2,13 L2,16 L5,16 L5,18 Z M16,18 L11,18 L11,16 L14,16 L14,13 L16,13 Z"/>
									</svg>
									{{ 'MIRROR_X' | translate }}
								</label>
								<select (change)="this.randomMirrorXSet($any($event.target).value)">
									<option value="random" [selected]="this.randomMirrorX ==='random'">{{ 'RANDOM_MIRROR' | translate }}</option>
									<option value="true" [selected]="this.randomMirrorX ==='true'">{{ 'YES' | translate }}</option>
									<option value="false" [selected]="this.randomMirrorX ==='false'">{{ 'NO' | translate }}</option>
								</select>
							</div>
							<div class="random-options">
								<label>
									<!-- https://www.svgrepo.com/svg/512262/focus-horizontal-838 Public Domain-->
									<svg width="20px" height="20px" viewBox="0 -2 20 20">
										<path d="M0,9 L0,7 L20,7 L20,9 Z M2,5 L2,0 L7,0 L7,2 L4,2 L4,5 Z M18,0 L18,5 L16,5 L16,2 L13,2 L13,0 Z M2,16 L2,11 L4,11 L4,14 L7,14 L7,16 Z M18,16 L13,16 L13,14 L16,14 L16,11 L18,11 Z"/>
									</svg>
									{{ 'MIRROR_Y' | translate }}
								</label>
								<select (change)="this.randomMirrorYSet($any($event.target).value)">
									<option value="random" [selected]="this.randomMirrorY ==='random'">{{ 'RANDOM_MIRROR' | translate }}</option>
									<option value="true" [selected]="this.randomMirrorY ==='true'">{{ 'YES' | translate }}</option>
									<option value="false" [selected]="this.randomMirrorY ==='false'">{{ 'NO' | translate }}</option>
								</select>
							</div>
							<div>
								<button (click)="generateRandomLayouts()" (keydown.enter)="generateRandomLayouts()">
									{{ 'GENERATE' | translate }}
								</button>
							</div>
						</div>
					</div>
				} @else {
					<div class="previews" appDeferLoadScrollHost>
						@for (item of group.layouts; track item) {
							<div class="preview"
									 tabindex="0"
									 [id]="'item-'+item.layout.id"
									 [class.selected]="item.selected"
									 (keydown.enter)="onStart(item)"
									 (click)="onStart(item)"
									 (appDeferLoad)="item.visible=true"
							>
								@if (item.visible) {
									<app-layout-preview class="svg-board" [svg]="item.layout.previewSVG" [alt]="item.layout.name"></app-layout-preview>
								} @else {
									<div class="preview-placeholder"
											 [id]="'item-'+item.layout.id"
											 [class.selected]="item.selected"
									>
									</div>
								}
								@if (item.bestTime) {
									<div class="preview-best-time">
										<span title="{{ 'STATS_BEST' | translate }}">{{ item.bestTime|duration }}</span>
										<a (click)="clearBestTimeClick($event, item)" title="{{ 'BEST_TIME_CLEAR' | translate }}">
											<i class="icon-cancel-squared"></i>
										</a>
									</div>
								}
								<div class="preview-name">{{ item.layout.name }}</div>
								@if (item.layout.custom) {
									<div class="preview-custom" title="{{ 'CUSTOM_BOARD_DELETE' | translate }}">
										<a (click)="removeCustomLayout($event, item)">
											<i class="icon-trash-empty"></i>
										</a>
									</div>
								}
							</div>
						}
					</div>
				}
			}
		</div>
	}
</div>
